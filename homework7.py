# Задача2. Поиск адресов
#
# Большинство адресов состоит из трёх частей: название улицы, номер дома и номер квартиры. Название улицы может
# состоять из нескольких слов, каждое из которых пишется с заглавной буквы. Номер дома может содержать после себя букву.
# Перед названием улицы может быть написано «Улица», «улица», «Ул.» или «ул.», перед номером дома— «дом» или «д.»,
# перед номером квартиры — «квартира» или «кв.». Также номер дома и номер квартиры могут быть разделены дефисом
# без пробелов.
# Дан текст, в нём нужно найти все адреса и вывести их в виде «Пушкина 32-135».
# Для упрощения мы не будем учитывать дома, которые находятся не на улицах, а на площадях, набережных, бульварах и так
# далее.
# Ввод:
# Добрый день!
# Сегодня на выезды потребуется отправить трёх-четырёх специалистов, остальных держите в офисе. Некоторые заявки
# пришли на конкретных людей, но можно вызвать и других, смотрите по ситуации, как лучше их отправить, чтобы всех
# объездить сегодня.
# Петрову П. П. попросили выехать по адресам ул.Культуры 78кв.6, улица Мира дом12Б квартира 144. Смирнова С. С. просят
# подъехать только по адресу: Восьмого Марта 106-19. Без предпочтений по специалистам пришли запросы с адресов: улица
# Свободы 54 6, Улица Шишкина дом 9 кв. 15, ул. Лермонтова 18 кв. 93.
# Все адреса скопированы из заявок, корректность подтверждена.
# Вывод
# Культуры 78-6
# Мира 12Б-144
# Восьмого Марта 106-19
# Свободы 54-6
# Шишкина 9-15
# Лермонтова 18-93

text = (
    "Добрый день! Сегодня на выезды потребуется отправить трёх-четырёх специалистов, остальных держите "
    "в офисе. Некоторые заявки пришли на конкретных людей, но можно вызвать и других, смотрите по ситуации, "
    "как лучше их отправить, чтобы всех объездить сегодня. Петрову П. П. попросили выехать "
    "по адресам ул. Культуры 78 кв. 6, улица Мира дом 12Б квартира 144. Смирнова С. С. просят подъехать "
    "только по адресу: Восьмого Марта 106-19. Без предпочтений по специалистам пришли запросы с адресов: "
    "улица Свободы 54 6, Улица Шишкина дом 9 кв. 15, ул. Лермонтова 18 кв. 93. Все адреса скопированы "
    "из заявок, корректность подтверждена."
)

import re


def extract_addresses(text):
    address_pattern = re.compile(
        r"\b(?:Улица|улица|Ул\.|ул\.)?\s*([А-ЯЁ][а-яё]+(?:\s+[А-ЯЁ][а-яё]*)*)\s+"
        r"(?:дом|д\.)?\s*(\d+[А-Яа-я]?)\s*(?:квартира|кв\.)?\s*(\d+)?"
        r"(?:[-\s])?(?:(\d+))?"
    )

    # \b - что бы избежать частичного совпадения в середине слова.
    # (?:Улица|улица|Ул\.|ул\.)? - группа или/или может встречаться 0 или 1 раз
    # s+ - пробел 1 или более
    # [А-ЯЁ][а-яё]+ - одна заглавная и одна или более строчная буква
    # (?:\s+[А-ЯЁ][а-яё]*)*) - повторение названия улицы если название состоит из двух слов * - 0 или более
    # (?:дом|д\.)?\s* - варианты названия дома и пробел. ? в конце значит не обязательная часть
    # (\d+[А-Яа-я]?) - цифра 1 или более и буква в доме если есть, типа 12Б (? - не обязательная часть)
    # (?:квартира|кв\.)?\s*(\d+)? - квартира если есть + номер квартиры
    # (?:[-\s])?(?:(\d+))? - дефис если есть пробел и цифра если есть. Цифра может захватится отдельно после
    # дефиса Пайчарм почему-то подчёркивает, но всё работает
    # Долго не мог захватить все адреса. Была путаница с пробелами. Эта регулярка вроде всё захватывает.

    matches = address_pattern.findall(text)
    addresses = []
    print(matches)
    for match in matches:
        street = match[0]
        house_number = match[1]
        apartment = match[2] or match[3]
        # Номер квартиры может быть в третьем или четвёртом элементе
        if apartment:
            address = f"{street} {house_number}-{apartment}"
        else:
            address = f"{street} {house_number}"

        addresses.append(address)

    return addresses


addresses = extract_addresses(text)

# Для вывода как в исходнике.
for address in addresses:
    print(address)
